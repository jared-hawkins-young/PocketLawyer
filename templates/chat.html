<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Chatbot</title>
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='style.css') }}">
    <script>
        function sendMessage() {
            var xhr = new XMLHttpRequest();
            var userMessage = document.getElementById("message").value;
            xhr.open("POST", "/send_message", true);
            xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
            xhr.onreadystatechange = function() {
                if (this.readyState === XMLHttpRequest.DONE && this.status === 200) {
                    updateChat(JSON.parse(this.responseText));
                    document.getElementById("message").value = "";  // Clear input field
                }
            }
            xhr.send("message=" + encodeURIComponent(userMessage));
        }

        function updateChat(conversation) {
            var chatDisplay = document.getElementById("chat-display");
            chatDisplay.innerHTML = "";  // Clear current display
            conversation.forEach(function(msg) {
                var messageDiv = document.createElement("div");
                messageDiv.classList.add("message", msg.role);
                messageDiv.textContent = msg.content;
                chatDisplay.appendChild(messageDiv);
            });
            chatDisplay.scrollTop = chatDisplay.scrollHeight; // Auto-scroll to the latest message
        }
    </script>
</head>
<body>
    <div id="chat-container">
        <h1>PocketLawyer</h1>
        <div id="chat-display">
            <!-- Chat messages will appear here -->
        </div>
        <input type="text" id="message" placeholder="Type your message here...">
        <button id="send-button" onclick="sendMessage()">Send</button>
    </div>
</body>
</html>



